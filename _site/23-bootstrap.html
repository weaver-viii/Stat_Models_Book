<!doctype html>
<html>
<head>

<!-- LaTeX -->

<script type="text/javascript"
src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<title>The Elements of Data Science: A Perspective from Applied Statistics and Machine Learning</title>

<link rel="stylesheet" href="stylesheets/styles.css">
<link rel="stylesheet" href="stylesheets/pygment_trac.css">
<!--	<link href='http://fonts.googleapis.com/css?family=Fanwood+Text:400,400italic' rel='stylesheet' type='text/css'> -->
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<!--[if lt IE 9]>
 <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
 <![endif]-->
</head>
<body>
<div class="wrapper">
<header>
<h1><a href="index.html">The Elements of Data Science: A Perspective from Applied Statistics and Machine Learning</a> <h1><a><medium>Bin Yu and Rebecca Barter</medium></a></h1></h1>
<p></p>

<p class="view"><a href="https://github.com/rlbarter/Stat_Models_Book">View the Project on GitHub <small>rlbarter/Stat_Models_Book</small></a></p>




</header>










<section>  



<h1>The Bootstrap</h1>

<p>The bootstrap is a method that uses sampling with replacement to generate empirical distributions in order to sidestep extreme distributional assumptions. In particular, it assumes that the notion of our observed sample being drawn from a population is analagous to the notion of a re-sample (with replacement) being drawn from our observed sample.</p>

<p>Making inference about our population (which, in most cases, we cannot observe) based on a sample drawn from the population is difficult to do without extreme theoretical assumptions. However, making inferences about our observed sample based on a re-sample (sample from our sample drawn with replacement) is easier because we can treat our observed sample as our &quot;population&quot;. </p>

<p>In the simplest case, suppose that $X_1, ..., X_n \overset{iid}{\sim} F$, for some unspecified distribution, $F$. Suppose that our first two moments are known, that is $EX_1 = \mu$ and $EX_q^2 = \sigma^2_X$. How could we calculate a confidence interval for $\mu$? If we had a large sample, we could use the central limit theorem (CLT) which says that asymptotically,</p>

<p>$$n (\bar{X} - \mu) \overset{d}{\rightarrow} N(0, \sigma_X^2)$$</p>

<p>and create a confidence interval of the form $(\bar{X} - 1.96 \frac{s}{\sqrt{n}}, \bar{X} + 1.96  \frac{s}{\sqrt{n}})$ where $1.96$ is the $97.5$th percentile of the Normal distirbution and $s$ is the estimated standard deviation of our population based on our sample. If our sample size is large enough, the central limit theorem tells us that this confidence interval for the mean is entirely reasonable.</p>

<p>However, what if we were interested in another statistic (recall that a statistic is defined to be any function of our data) for which we did not have such a nice asymptotic distributional result. Consider, for example, the the median, or some arbitrary model parameter estimate, $\hat{\beta}$? We could use the bootstrap method to estimate properties of our statistic based on empirical distributions (rather than by drawing potentially unrealistic distributional assumptions). </p>

<h3>The nonparametric approach</h3>

<p>For simplicity, we will demonstrate using the bootstrap to generate a confidence interval for the sample mean, $\overline{X}$ (pretending that we are ignorant to the central limit theorem). To begin, let&#39;s consider the data (the observed values of the $X_i$&#39;s) as a &quot;little popuation&quot;, a term used in the <em>Statistical Models: Theory and Practice</em> by David A. Freedman. Next, we simulate $n$ drawns, made at random <em>with replacement</em> from this little population (so that some observations will likely be drawn more than once and others not at all) to get a <strong>bootstrap sample</strong> $X_1^*, ..., X_n^*$ of the same size as our original sample (see Figure 1, sourced from Freedman).</p>

<p><img src="Bootstrap.png" alt="Bootstrap" style="width:500px;height:200px;"></p>

<p>From a bootstrap sample, we can generate a bootstrap estimator, $\overline{X}^* = \frac{1}{n} \sum_{i=1}^n X_i^*$. However, given that we are interested in exploring the <em>distribution</em> of our original estimator, $\bar{X}$, a single draw, $\overline{X}^*$, from our &quot;population&quot; of estimators is not hugely helpful. What we really want is to generate many $\bar{X}^*$s to form an empirical distribution for $\overline{X}$, from which we can estimate its properties such as its variance. Thus, we typically generate $M$ (usually $M &gt; 100$) bootstrap samples in order to obtain $M$ bootstrap estimates of $\overline{X}$:</p>

<p>$$X_1^{*(1)}, X_2^{*(1)}, ..., X_n^{*(1)}, \text{ generates the estimate } \overline{X}_{(1)}^{*}$$
$$X_1^{*(2)}, X_2^{*(2)}, ..., X_n^{*(2)} \text{ generates the estimate } \overline{X}_{(2)}^{*}$$
$$ \vdots $$
$$X_1^{*(M)}, X_2^{*(M)}, ..., X_n^{*(M)} \text{ generates the estimate } \overline{X}_{(M)}^{*}$$</p>

<p>The idea is that as $M$ gets large, the distribution of $\overline{X}^* - \overline{X}$ will be a good approximation for the distribution of $\overline{X} -\mu$. In particular, we should have that</p>

<p>$$P\left(\frac{ \overline{X} - \mu}{\sigma_X} &lt; t \right) \approx P\left(\frac{ \overline{X}^* - \overline{X}}{\sigma_X} &lt; t \right)$$</p>

<p>by which we mean that the process of sampling from the population should be comparable to the process of taking a bootstrap sample from our original sample. Thus, since we can never observe $\mu$ but we do observe both $\overline{X}^*$ and $\overline{X}$, we can use the probability on the RHS of the above expression to estimate the probability of interest on the LHS.</p>

<p>It is important to make the following distinction: since the bootstrap estimators, $\overline{X}^*$, are generated by sampling from the original <em>sample</em> (rather than the population), whose mean is $\overline{X}$ (rather than $\mu$), it follows that $\overline{X}^*$ is not a new estimator for the parameter $\mu$, but rather is something that we have generated to better understand the original estimator, $\overline{X}$. For instance, if we define 
$$ \overline{X}_{ave}^* = \frac{1}{M} \sum_{k=1}^M \overline{X}_{(k)}^*$$ </p>

<p>then we can estimate the true bias of our estimator, which is defined by $bias(\overline{X}) = E\left(\overline{X}\right) - \mu$, to be</p>

<p>$$bias(\overline{X}) \approx \overline{X} - \overline{X}_{ave}^*$$</p>

<p>and similarly the standard error of $\overline{X}$ to be</p>

<p>$$SE(\bar{X}) \approx \sqrt{\frac{1}{M} \sum_{k=1}^M \left( \overline{X}_{(k)}^* - \overline{X}_{ave}^*\right)^2}$$</p>

<p>Note that the procedure described above is that of the <em>nonparametric bootstrap</em> for the sample mean in the sense that it makes absolutely no assumptions on the form of the original distribution, $F_X$, of the data. </p>

<h4>The Nonparametric bootstrap in standard regression</h4>

<p>There are many ways to apply bootstrapping to a regression problem. Suppose that we have the model</p>

<p>$$Y = X \beta + \epsilon$$</p>

<p>where $\epsilon_1, ..., \epsilon_n \sim N(0, \sigma^2)$ and that we are interested in obtaining the properties of the OLS estimator for $\hat{\beta}_{OLS} = (X^TX)^{-1}X^TY$ but don&#39;t know any of the theoretical properties (let&#39;s ignore the fact that we know, for example, that the bias is $0$ and the covariance matrix is $\sigma^2(X^TX)^{-1}$). There are a number of ways that we could conceivably use the bootstrap procedure to estimate properties of $\hat{\beta}_{OLS}$ such as its bias and variance.</p>

<p>The primary approach for to generating a bootstrap sample for $\hat{\beta}_{OLS}$ involves generating a bootstrap sample of the responses, $y_1^*, ..., y_n^*$, so that we can define our bootstrap sample for $\hat{\beta}_{OLS}$ to be</p>

<p>$$\hat{\beta}_{OLS}^* = (X^TX)^{-1}X^TY^*$$</p>

<p>where $Y^* = [y_1^*, ..., y_n^*]^T$. The naive approach to doing this is to simply bootstrap the $y_1, ..., y_n$ by sampling with replacement as in the example above. However, recall that in a linear model such as $Y = X \beta  + \epsilon$, the randomness in the $Y$ comes from the iid random errors $\epsilon_1, ..., \epsilon_n$, and by construction, the $y_i$&#39;s are not drawn from the same distribution (e.g. each $y_i$ has a different mean $E(y_i) = x_i^T\beta$), making directly bootstrapping the $y_i$&#39;s the entirely wrong thing to do. Thus, it makes more sense to bootstrap the errors $\epsilon_1, ..., \epsilon_n$, rather than the responses. There&#39;s just one problem... we never actually observe the $\epsilon_i$&#39;s.</p>

<p>One reasonable approach would be to approximate the distribution of the errors, $\epsilon_i$, by the distribution of the corresponding model residuals, $e_i = y_i - x_i^T \hat{\beta}_{OLS}$ (if the fitted model was actually the true model, then the residuals would be equal to the true errors). More specifically, we can define our &quot;little population&quot; to be the set of $n$ residuals, $e_1, ..., e_n$, and from this little population we will draw $n$ observations at random with replacement to get the bootstrap sample, $\epsilon_1^*, ..., \epsilon_n^*$, from which we can generate the bootstrap sample of the $y_i$s to get </p>

<p>$$y_i^* = x_i^T\hat{\beta}_{OLS} + \epsilon_i^*, ~~~~ i = 1, ..., n$$ </p>

<p>Further we can obtain a bootstrap sample of our OLS estimator of $\hat{\beta}_{OLS}$ by</p>

<p>$$\hat{\beta}^* = (X^TX)^{-1}X^T Y^*$$</p>

<p>and we can generate $M$ such bootstrap samples, $\hat{\beta}^*_{(k)}, k = 1, ..., M$.</p>

<p>Again, the idea is that if the sample size is large enough, then the empirical distribution given by $\hat{\beta}^*_{(k)} - \hat{\beta}_{OLS}, k = 1, ..., M$ is a good approximation to the distribution of $\hat{\beta}_{OLS} - \beta$. In particular, we have that</p>

<p>$$\sqrt{n} \left( \hat{\beta}_{OLS} - \beta\right) \overset{d}{\approx} \sqrt{n}\left(\hat{\beta}^* - \hat{\beta}_{OLS}\right)$$</p>

<p>It is worth noting that when the true distirbution of $\epsilon$ has heavy tails, CLT and bootstrap approaches are less accurate.</p>

<h3>The parametric approach</h3>

<p>In the nonparametric approach to the bootstrap that we have discussed so far, we have made no distributional assumptions on our data, and have simply used the sample as our bootstrap population. However, it is concievable that one might have an idea the form of the true distribution of the data although be ignorant of the true parameter values. For example, one might have binary data from which it might not seem unreasonable that the data, $X_1, ..., X_n$ comes from a $Bernoulli(p)$ distirbution, i.e. that each observation is either $0$ or $1$ with a fixed probability, but that the true value of the parameter, $p = P(X_i = 1)$ is unknown. Certainly we can estimate $p$ by the proportion of $1$&#39;s in our data (let&#39;s call this estimate $\hat{p}$). In this case, to generate a bootstrap sample, instead of sampling without replacement from the $X_1, ..., X_n$ (the nonparametric approach), we could draw samples from the estimated $Bernoulli(\hat{p})$ distribution. </p>

<p>To place this notion in more general terms, suppose we knew that our data $X_1, ..., X_n \sim F(\theta)$, but that $\theta$ was unknown. We could use the overved data to generate an estimate, $\hat{\theta}$, of the distirbution parameter, and we could then draw our bootstrap samples from $F^* = F(\hat{\theta})$ to obtain</p>

<p>$$X_1^* , ..., X_n^* \sim F\left(\hat{\theta}\right)$$</p>

<p>and repeat this $M$ times so that we could generate $M$ bootstraped versions of our statistic of interest, $T(X)$ (for example, we might have $T(X) = \bar{X}$):</p>

<p>$$X_1^{*(1)}, X_2^{*(1)}, ..., X_n^{*(1)} \sim F(\hat{\theta}), \text{ generates the estimate } T(X)_{(1)}^{*}$$
$$X_1^{*(2)}, X_2^{*(2)}, ..., X_n^{*(2)} \sim F(\hat{\theta})\text{ generates the estimate } T(X)_{(2)}^{*}$$
$$ \vdots $$
$$X_1^{*(M)}, X_2^{*(M)}, ..., X_n^{*(M)} \sim F(\hat{\theta})\text{ generates the estimate } T(X)_{(M)}^{*}$$</p>

<h4>The parametric bootstrap in logistic regression</h4>

<p>Unlike for standard linear regression, the maximum likelihood estimate (MLE) for logistic regression which is typically calcualted iteratively has less straightforward theoretical properties. Suppose that we have a dataset with binary responses, $y_1, ..., y_n \in {0, 1}$, and some predictor variables, $x_{i1}, ..., x_{ip}$, for each $y_i$. Recall that the logistic regression model assumes that the $y_i \sim Bernoulli(\pi_i)$, where the probability, $\pi_i$ was logistically related to the $x_i^T$, i.e.</p>

<p>$$\pi_i = \frac{e^{x_i^T\beta}}{1 + e^{x_i^T\beta}}$$</p>

<p>For this model, there is no closed form solution for the optimal $\beta$, so we typically calculate an approximation to the MLE, $\hat{\beta}_{MLE}$, using iterative methods. How can we use the bootstrap to examine properties of our estimator, $\hat{\beta}_{MLE}$? This is a slightly more complex problem than the standard linear regression problem above, but again, if we could draw bootstrap samples from the $y = (y_1, ..., y_n)$ directly, then we could use our $M$ bootstrapped samples $(y^*_{(k)}, X_{(k)})_{k = 1, ..., M}$ to obtain estimates, $\hat{\beta}^*_{(1)},..., \hat{\beta}^*_{(M)}$, of $\hat{\beta}_{MLE}$.</p>

<p>The standard parametric approach is to use our inital estimate $\hat{\beta}_{MLE}$ to estimate $\pi_i$ by</p>

<p>$$\hat{\pi}_i = \frac{e^{x_i^T\hat{\beta}_{MLE}}}{1 + e^{x_i^T\hat{\beta}_{MLE}}}$$</p>

<p>using which we could simulate a sample of size $n$, $y_1^*, ..., y_n^*$, where $y_i^* \sim Bernoulli(\hat{\pi}_i)$ (this is where the parametric assumption comes in - we are assuming that the $y_i$ have a Bernoulli distribution). Repeating this $M$ times, we would have $M$ bootstrap samples from which we could obtain $M$ estimates, $\hat{\beta}^*_{(1)}, ..., \hat{\beta}^*_{(M)}$ of $\hat{\beta}_{MLE}$.</p>

<p>We can use these $M$ bootstrapped estimates to approximate the distribution of $\hat{\beta}_{MLE}$ from which we can estimate properties of our estimator. </p>

<p>What would be different if we were instead performing nonparametric bootstrapping for this example? We could use the sampling-with-replacement approach from our &quot;little population&quot; defined by $(x_1, y_1), ..., (x_n , y_n)$ to generate bootatrap samples of the form $(x_1^*, y_1^*), ..., (x_n^*, y_n^*)$. From this bootstrap sample, we could obtain the a bootstrap estimate $\hat{\beta}_{MLE}^*$, and so on. This approach is actually extremely common (primarily since it is simple and very intuitive) and can be used for arbitrary GLMs, not just for logistic regression.</p>

<h1>Further Reading</h1>

<p>Peter Hall&#39;s book.</p>



</section>

<footer>

<p><small>Site powered by <a href="http://jekyllrb.com/">Jekyll, <a href="http://pandoc.org/">pandoc and <a href="http://yihui.name/knitr/">knitr</a>.</small></p>
</footer>


</div>
<script src="javascripts/scale.fix.js"></script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-39541792-2', 'github.com');
ga('send', 'pageview');
</script>    
</body>
</html>